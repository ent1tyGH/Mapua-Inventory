<div class="container">
  <!-- ✅ LEFT COLUMN -->
  <div class="left-section">
    <!-- Item Form -->
    <div class="form-card">
      <h2>{{ isEditing ? 'Update Item' : 'Add Item' }}</h2>

      <form (ngSubmit)="isEditing ? updateItem() : addItem()">
        <label>Equipment Type: </label>
        <select [(ngModel)]="newItem.equipmentType.id" name="equipmentTypeId" required>
          <option [ngValue]="0" disabled>Select Type</option>
          <option *ngFor="let type of equipmentTypes" [ngValue]="type.id">{{ type.name }}</option>
        </select>

        <label>Specifications: </label>
        <input type="text" [(ngModel)]="newItem.specifications" name="specifications" required />

        <label>Location: </label>
        <input type="text" [(ngModel)]="newItem.location" name="location" required />

        <label>Condition: </label>
        <select [(ngModel)]="newItem.conditionStatus" name="conditionStatus" required>
          <option>WORKING</option>
          <option>NEEDS_REPAIR</option>
          <option>DISPOSED</option>
        </select>

        <div class="button-group">
    <button *ngIf="!isEditing" type="submit" class="submit-btn">Add Item</button>
    <button *ngIf="isEditing" type="submit" class="update-btn">Save Changes</button>
    <button *ngIf="isEditing" type="button" class="reset-btn" (click)="cancelEdit()">Cancel</button>
    <button
      *ngIf="!isEditing"
      type="button"
      class="btn btn-primary"
      [routerLink]="'/equipment-types'">
      Add Equipment Type
    </button>
  </div>
    </form>
  </div>

    <!-- 🔍 Search Bar (below form) -->
    <div class="search-filter">
      <input
        type="text"
        [(ngModel)]="searchText"
        (input)="applyFilter()"
        placeholder="🔍 Search items..."
      />

      <div class="checkbox-group">
        <label>
          <input type="checkbox" [(ngModel)]="showAvailable" (change)="applyFilter()" />
          Show Available
        </label>
        <label>
          <input type="checkbox" [(ngModel)]="showBorrowed" (change)="applyFilter()" />
          Show Borrowed
        </label>
      </div>
      <!-- ✅ New Condition Filter Row -->
      <div class="checkbox-group condition-filters">
        <label class="working">
          <input type="checkbox" [(ngModel)]="filterWorking" (change)="applyFilter()" />
          Working
        </label>
        <label class="needs-repair">
          <input type="checkbox" [(ngModel)]="filterNeedsRepair" (change)="applyFilter()" />
          Needs Repair
        </label>
        <label class="disposed">
          <input type="checkbox" [(ngModel)]="filterDisposed" (change)="applyFilter()" />
          Disposed
        </label>
      </div>
    </div>
  </div>

  <!-- ✅ RIGHT COLUMN -->
  <div class="right-section">
    <div class="dashboard">

      <!-- Equipment Type Selector -->
      <div class="dashboard-controls">
        <label for="equipmentTypeFilter">Equipment Type:</label>
        <select id="equipmentTypeFilter" [(ngModel)]="selectedTypeId" (change)="updateDashboard()">
          <option [ngValue]="0">All Items</option>
          <option *ngFor="let type of equipmentTypes" [ngValue]="type.id">{{ type.name }}</option>
        </select>
      </div>

      <!-- Dashboard Stats -->
      <div class="dashboard-stats">
        <div class="stat-card total">
          <h3>Total Items</h3>
          <p>{{ dashboardData.total }}</p>
        </div>
        <div class="stat-card available">
          <h3>Available</h3>
          <p>{{ dashboardData.available }}</p>
        </div>
        <div class="stat-card borrowed">
          <h3>Borrowed</h3>
          <p>{{ dashboardData.borrowed }}</p>
        </div>
      </div>
    </div>


    <!-- Item List -->
    <div class="item-list">
      <div class="item-card" *ngFor="let item of filteredItems">
        <div class="item-header">
          <h3>{{ item.equipmentType.name }}</h3>
          <span class="item-id">ID: {{ item.id }}</span>
        </div>

        <p><strong>Specs:</strong> {{ item.specifications }}</p>
        <p><strong>Location:</strong> {{ item.location }}</p>

        <p>
          <strong>Condition:</strong>
          <span class="badge"
                [ngClass]="{
              'badge-working': item.conditionStatus === 'WORKING',
              'badge-repair': item.conditionStatus === 'NEEDS_REPAIR',
              'badge-disposed': item.conditionStatus === 'DISPOSED'
            }">
            {{ item.conditionStatus }}
          </span>
        </p>

        <p>
          <strong>Borrowed:</strong>
          <span class="badge"
                [ngClass]="{
              'badge-yes': item.borrowed,
              'badge-no': !item.borrowed
            }">
            {{ item.borrowed ? 'Yes' : 'No' }}
          </span>
        </p>

        <div class="button-group">
          <button
            class="borrow-btn"
            *ngIf="!item.borrowed"
            [routerLink]="['/borrowers']"
            [queryParams]="{ itemId: item.id }">
            Borrow
          </button>

          <button
            class="return-btn"
            *ngIf="item.borrowed"
            [routerLink]="['/return']"
            [queryParams]="{ itemId: item.id }">
            Return
          </button>

          <button class="edit-btn" (click)="editItem(item)">
            <i class="fas fa-edit"></i> Edit
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
