<div class="container">
  <div class="form-card">
    <h2>Return Item</h2>

    <div *ngIf="successMessage" class="toast-message success">
      {{ successMessage }}
    </div>
    <div *ngIf="errorMessage" class="toast-message error">
      {{ errorMessage }}
    </div>

    <!-- Step 1: Tap ID / Enter borrower serial -->
    <form *ngIf="!borrowedItems" (ngSubmit)="fetchBorrowedItems()" #borrowForm="ngForm">
      <label for="serialNumber">Borrower Serial Number:</label>
      <input
        id="serialNumber"
        type="text"
        [(ngModel)]="serialNumber"
        name="serialNumber"
        required
      />
      <button type="submit" class="btn-confirm" [disabled]="borrowForm.invalid">
        Fetch Borrowed Items
      </button>
    </form>

    <!-- Step 2: Show list of borrowed items -->
    <div *ngIf="borrowedItems">
      <h3>Borrowed Items</h3>
      <ul>
        <li *ngFor="let record of borrowedItems">
          <strong>{{ record.item.equipmentType.name }}</strong>
          <span> (Borrowed at: {{ record.borrowedAt | date:'short' }}) </span>

          <div class="return-form">
            <label>Remarks:</label>
            <input type="text" [(ngModel)]="record.remarks" placeholder="Enter remarks" />

            <label>Condition Status:</label>
            <select [(ngModel)]="record.conditionStatus">
              <option value="" disabled selected>Select condition</option>
              <option value="WORKING">Working</option>
              <option value="NEEDS_REPAIR">Needs Repair</option>
              <option value="DISPOSED">Disposed</option>
            </select>

            <button (click)="returnItem(record.item.id, record)">Return</button>
          </div>
        </li>
      </ul>

      <button (click)="resetForm()" class="btn-secondary">‚Üê Back</button>
    </div>
  </div>
</div>
